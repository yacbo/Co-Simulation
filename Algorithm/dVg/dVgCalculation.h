#pragma once

#include "mdarray.h"

/*母线类型*/
#define BUS_TYPE_NORMAL	0	//普通母线
#define BUS_TYPE_PBUS	1	//中枢母线
#define BUS_TYPE_M	2	//发电机

#define PI	3.1415926 //π的值
#define NUM_M	10	//发电机数量
#define NUM_PBUS	6	//中枢母线数量
#define NUM_NORMAL	39-NUM_M-NUM_PBUS	//普通母线数量

/////////////////////
/*矩阵赋值，以下为程序所需要的矩阵*/
/*赵丽莉整理*/
////////////////////
/* 发电机编号 */
int MachineNo[NUM_M] = { 39,38,31,32,30,37,33,34,35,36 };
/* 中枢母线编号 */
int PilotBusNo[NUM_PBUS] = { 1,28,6,3,19,23 };

double Cg[39][39]=
{
	{ 0.0706823 , 0.0940425 , 0.0981354 , 0.0988103 , 0.0978351 , 0.0978808 , 0.0970597 , 0.0966049 , 0.0879783 , 0.0989626 , 0.0986399 , 0.0983568 , 0.099254  , 0.0998859 , 0.102319  , 0.103115  , 0.102398  , 0.100861  , 0.103423  , 0.109629 , 0.103838  , 0.104216  , 0.104253   ,0.103391   ,0.0975228 , 0.104414  ,0.103719  , 0.107706 , 0.107911 , 0.0963936 ,0.104732  , 0.10589   , 0.110663  ,0.110615 , 0.106821  , 0.104253  , 0.0999608 , 0.110609 , 0.0803107 },
	{ 0.0940425 , 0.0850653 , 0.0920766 , 0.0964969 , 0.0977658 , 0.0978824 , 0.0981205 , 0.0981965 , 0.0991041 , 0.0978962 , 0.0979185 , 0.097297  , 0.097843  , 0.0975871 , 0.0981562 , 0.0981533 , 0.0967532 , 0.095053  , 0.098447  , 0.104354 , 0.0988422 , 0.0992016 , 0.0992374  ,0.0984164  ,0.0890026 , 0.097028  ,0.0971197 , 0.100087 , 0.100278 , 0.087192  ,0.104734  , 0.104749  , 0.105338  ,0.105293 , 0.101682  , 0.0992374 , 0.0912276 , 0.102785 , 0.0977668 },
	{ 0.0981354 , 0.0920766 , 0.0867556 , 0.0928796 , 0.0948742 , 0.0950276 , 0.095562  , 0.0957878 , 0.0994631 , 0.0948279 , 0.0949184 , 0.0942474 , 0.0947074 , 0.0942819 , 0.0950377 , 0.0951238 , 0.0938509 , 0.0912246 , 0.0954085 , 0.101133 , 0.0957915 , 0.0961398 , 0.0961744  ,0.0953788  ,0.0942599 , 0.0982276 ,0.09643   , 0.101325 , 0.101518 , 0.0943785 ,0.10168   , 0.101466  , 0.102087  ,0.102043 , 0.0985433 , 0.0961744 , 0.0966164 , 0.104056 , 0.10002 },
	{ 0.0988103 , 0.0964969 , 0.0928796 , 0.0838777 , 0.0872947 , 0.0876037 , 0.0884255 , 0.0887987 , 0.0956217 , 0.0877663 , 0.0877377 , 0.0872291 , 0.0877672 , 0.0876631 , 0.0931788 , 0.0953362 , 0.0960156 , 0.094903  , 0.0956216 , 0.101359 , 0.0960054 , 0.0963545 , 0.0963892  ,0.0955918  ,0.0983378 , 0.10148   ,0.0991882 , 0.10468  , 0.104879 , 0.0989094 ,0.0937359 , 0.0939099 , 0.102315  ,0.102271 , 0.0987633 , 0.0963892 , 0.100796  , 0.107501 , 0.0984174 },
	{ 0.0978351 , 0.0977658 , 0.0948742 , 0.0872947 , 0.0813798 , 0.0822788 , 0.0830743 , 0.0834366 , 0.0920236 , 0.0852407 , 0.0843064 , 0.0847189 , 0.0861481 , 0.0883855 , 0.0943747 , 0.0967347 , 0.0975854 , 0.0966364 , 0.0970242 , 0.102846 , 0.0974137 , 0.0977678 , 0.0978031  ,0.0969939  ,0.0996895 , 0.103007  ,0.100738  , 0.106254 , 0.106457 , 0.10021   ,0.0880383 , 0.0912076 , 0.103816  ,0.103771 , 0.100212  , 0.0978031 , 0.102182  , 0.109118 , 0.0961025 },
	{ 0.0978808 , 0.0978824 , 0.0950276 , 0.0876037 , 0.0822788 , 0.0809152 , 0.0825492 , 0.0833324 , 0.0919819 , 0.0844187 , 0.0833091 , 0.083902  , 0.0855017 , 0.088193  , 0.0943118 , 0.0967282 , 0.0976323 , 0.096724  , 0.0970177 , 0.102839 , 0.0974071 , 0.0977613 , 0.0977965  ,0.0969875  ,0.0997952 , 0.103086  ,0.100803  , 0.106336 , 0.106539 , 0.100329  ,0.0865793 , 0.090328  , 0.103809  ,0.103764 , 0.100205  , 0.0977965 , 0.10229   , 0.109202 , 0.0961045 },
	{ 0.0970597 , 0.0981205 , 0.095562  , 0.0884255 , 0.0830743 , 0.0825492 , 0.0781174 , 0.0804944 , 0.0899446 , 0.0857702 , 0.0847523 , 0.0852452 , 0.086761  , 0.0892129 , 0.0951447 , 0.0974777 , 0.0982924 , 0.0973367 , 0.0977694 , 0.103636 , 0.0981619 , 0.0985188 , 0.0985543  ,0.0977389  ,0.100119  , 0.103601  ,0.101386  , 0.106868 , 0.107071 , 0.100574  ,0.0883277 , 0.0917741 , 0.104613  ,0.104568 , 0.100982  , 0.0985543 , 0.102622  , 0.109748 , 0.0946577 },
	{ 0.0966049 , 0.0981965 , 0.0957878 , 0.0887987 , 0.0834366 , 0.0833324 , 0.0804944 , 0.0790351 , 0.0888828 , 0.0864102 , 0.0854387 , 0.0858812 , 0.0873543 , 0.0896851 , 0.0955203 , 0.0978105 , 0.09858   , 0.097601  , 0.0981032 , 0.103989 , 0.0984971 , 0.0988552 , 0.0988908  ,0.0980727  ,0.100237  , 0.103813  ,0.101633  , 0.107087 , 0.107291 , 0.100651  ,0.0891657 , 0.0924589 , 0.10497   ,0.104925 , 0.101327  , 0.0988908 , 0.102743  , 0.109973 , 0.09389 },
	{ 0.0879783 , 0.0991041 , 0.0994631 , 0.0956217 , 0.0920236 , 0.0919819 , 0.0899446 , 0.0888828 , 0.0693831 , 0.0942747 , 0.0935592 , 0.0936976 , 0.0949604 , 0.0966151 , 0.101129  , 0.102831  , 0.102974  , 0.101724  , 0.103138  , 0.109327 , 0.103552  , 0.103929  , 0.103966   ,0.103106   ,0.101829  , 0.106949  ,0.105356  , 0.110321 , 0.110531 , 0.101582  ,0.0984206 , 0.100874  , 0.110358  ,0.110311 , 0.106527  , 0.103966  , 0.104374  , 0.113295 , 0.0796531 },
	{ 0.0989626 , 0.0978962 , 0.0948279 , 0.0877663 , 0.0852407 , 0.0844187 , 0.0857702 , 0.0864102 , 0.0942747 , 0.0784169 , 0.0805116 , 0.0800925 , 0.0806346 , 0.0857536 , 0.0927107 , 0.095495  , 0.096764  , 0.0961103 , 0.0957808 , 0.101528 , 0.0961653 , 0.096515  , 0.0965497  ,0.095751   ,0.0996407 , 0.102549  ,0.100112  , 0.105783 , 0.105984 , 0.100344  ,0.090328  , 0.0839061 , 0.102485  ,0.102441 , 0.0989278 , 0.0965497 , 0.102132  , 0.108634 , 0.0978127 },
	{ 0.0986399 , 0.0979185 , 0.0949184 , 0.0877377 , 0.0843064 , 0.0833091 , 0.0847523 , 0.0854387 , 0.0935592 , 0.0805116 , 0.0787677 , 0.0800188 , 0.0822301 , 0.0865657 , 0.0932536 , 0.0959198 , 0.0970712 , 0.0963349 , 0.0962069 , 0.101979 , 0.0965931 , 0.0969443 , 0.0969792  ,0.0961769  ,0.0997179 , 0.102751  ,0.100363  , 0.105991 , 0.106192 , 0.100366  ,0.0891407 , 0.0861474 , 0.102941  ,0.102897 , 0.0993679 , 0.0969792 , 0.102211  , 0.108847 , 0.0972871 },
	{ 0.0983568 , 0.097297  , 0.0942474 , 0.0872291 , 0.0847189 , 0.083902  , 0.0852452 , 0.0858812 , 0.0936976 , 0.0800925 , 0.0800188 , 0.0580819 , 0.080141  , 0.0852287 , 0.0921431 , 0.0949105 , 0.0961717 , 0.0955219 , 0.0951945 , 0.100906 , 0.0955767 , 0.0959242 , 0.0959587  ,0.0951648  ,0.0990308 , 0.101922  ,0.099499  , 0.105135 , 0.105335 , 0.0997294 ,0.0897751 , 0.085699  , 0.101858  ,0.101814 , 0.0983223 , 0.0959587 , 0.101507  , 0.107969 , 0.0972139 },
	{ 0.099254  , 0.097843  , 0.0947074 , 0.0877672 , 0.0861481 , 0.0855017 , 0.086761  , 0.0873543 , 0.0949604 , 0.0806346 , 0.0822301 , 0.080141  , 0.0790136 , 0.0849144 , 0.0921384 , 0.0950401 , 0.0964263 , 0.0958552 , 0.0953245 , 0.101044 , 0.0957072 , 0.0960552 , 0.0960898  ,0.0952948  ,0.0995321 , 0.102316  ,0.0998295 , 0.105542 , 0.105742 , 0.100289  ,0.0914868 , 0.086279  , 0.101997  ,0.101953 , 0.0984565 , 0.0960898 , 0.10202   , 0.108386 , 0.0983073 },
	{ 0.0998859 , 0.0975871 , 0.0942819 , 0.0876631 , 0.0883855 , 0.088193  , 0.0892129 , 0.0896851 , 0.0966151 , 0.0857536 , 0.0865657 , 0.0852287 , 0.0849144 , 0.0826458 , 0.0905498 , 0.0937508 , 0.095438  , 0.0950809 , 0.0940314 , 0.0996733, 0.0944089 , 0.0947521 , 0.0947862  ,0.0940021  ,0.0991311 , 0.101588  ,0.0989799 , 0.104791 , 0.10499  , 0.100027  ,0.0943665 , 0.0917564 , 0.100614  ,0.10057  , 0.0971209 , 0.0947862 , 0.101609  , 0.107615 , 0.0994647 },
	{ 0.102319  , 0.0981562 , 0.0950377 , 0.0931788 , 0.0943747 , 0.0943118 , 0.0951447 , 0.0955203 , 0.101129  , 0.0927107 , 0.0932536 , 0.0921431 , 0.0921384 , 0.0905498 , 0.0820353 , 0.0876158 , 0.0916366 , 0.0930163 , 0.087878  , 0.0931507, 0.0882308 , 0.0885516 , 0.0885835  ,0.0878506  ,0.0988764 , 0.0994568 ,0.0960736 , 0.102593 , 0.102788 , 0.10061   ,0.100914  , 0.0992004 , 0.0940295 ,0.0939891, 0.0907654 , 0.0885835 , 0.101348  , 0.105358 , 0.102981 },
	{ 0.103115  , 0.0981533 , 0.0951238 , 0.0953362 , 0.0967347 , 0.0967282 , 0.0974777 , 0.0978105 , 0.102831  , 0.095495  , 0.0959198 , 0.0949105 , 0.0950401 , 0.0937508 , 0.0876158 , 0.084729  , 0.0897528 , 0.091883  , 0.0849826 , 0.0900816, 0.0853238 , 0.085634  , 0.0856648  ,0.0849561  ,0.098514  ,0.0982782  ,0.0945671 , 0.101377 , 0.10157  , 0.100607  ,0.103499  , 0.10218   , 0.0909314 ,0.0908923, 0.0877749 , 0.0856648 , 0.100977  , 0.104109 , 0.104245 },
	{ 0.102398  , 0.0967532 , 0.0938509 , 0.0960156 , 0.0975854 , 0.0976323 , 0.0982924 , 0.09858   , 0.102974  , 0.096764  , 0.0970712 , 0.0961717 , 0.0964263 , 0.095438  , 0.0916366 , 0.0897528 , 0.0866967 , 0.0895051 , 0.0900214 , 0.0954227, 0.0903828 , 0.0907114 , 0.0907441  ,0.0899933  ,0.0967695 , 0.0957665 ,0.0917987 , 0.098786 , 0.0989741, 0.0991721 ,0.104467  , 0.103538  , 0.0963229 ,0.0962815, 0.0929792 , 0.0907441 , 0.0991887 , 0.101448 , 0.103955 },
	{ 0.100861  , 0.095053  , 0.0912246 , 0.094903  , 0.0966364 , 0.096724  , 0.0973367 , 0.097601  , 0.101724  , 0.0961103 , 0.0963349 , 0.0955219 , 0.0958552 , 0.0950809 , 0.0930163 , 0.091883  , 0.0895051 , 0.0851276 , 0.092158  , 0.0976874, 0.0925279 , 0.0928643 , 0.0928978  ,0.0921292  ,0.0958968 , 0.0967909 ,0.0936482 , 0.0998427, 0.100033 , 0.0974294 ,0.103495  , 0.102838  , 0.098609  ,0.0985666, 0.0951859 , 0.0928978 , 0.0982942 , 0.102534 , 0.102544 },
	{ 0.103423  , 0.098447  , 0.0954085 , 0.0956216 , 0.0970242 , 0.0970177 , 0.0977694 , 0.0981032 , 0.103138  , 0.0957808 , 0.0962069 , 0.0951945 , 0.0953245 , 0.0940314 , 0.087878  , 0.0849826 , 0.0900214 , 0.092158  , 0.0655469 , 0.0694798, 0.0855791 , 0.0858903 , 0.0859212  ,0.0852104  ,0.0988089 , 0.0985723 ,0.0948501 , 0.10168  , 0.101874 , 0.100908  ,0.103809  , 0.102485  , 0.0701352 ,0.0701051, 0.0880376 , 0.0859212 , 0.101279  , 0.104421 , 0.104557 },
	{ 0.109629  , 0.104354  , 0.101133  , 0.101359  , 0.102846  , 0.102839  , 0.103636  , 0.103989  , 0.109327  , 0.101528  , 0.101979  , 0.100906  , 0.101044  , 0.0996733 , 0.0931507 , 0.0900816 , 0.0954227 , 0.0976874 , 0.0694798 , 0.059813 , 0.0907139 , 0.0910437 , 0.0910765  ,0.090323   ,0.104737  ,0.104487   ,0.100541  , 0.107781 , 0.107986 , 0.106963  ,0.110037  , 0.108635  , 0.0743433 ,0.0603513, 0.0933198 , 0.0910765 , 0.107356  , 0.110686 , 0.110831 },
	{ 0.103838  , 0.0988422 , 0.0957915 , 0.0960054 , 0.0974137 , 0.0974071 , 0.0981619 , 0.0984971 , 0.103552  , 0.0961653 , 0.0965931 , 0.0955767 , 0.0957072 , 0.0944089 , 0.0882308 , 0.0853238 , 0.0903828 , 0.0925279 , 0.0855791 , 0.0907139, 0.0746561 , 0.0773737 , 0.079074   ,0.084515   ,0.0992055 , 0.098968  ,0.0952309 , 0.102088 , 0.102283 , 0.101313  ,0.104226  , 0.102897  , 0.0915697 ,0.0915303, 0.0793081 , 0.079074  , 0.101686  , 0.10484  , 0.104977 },
	{ 0.104216  , 0.0992016 , 0.0961398 , 0.0963545 , 0.0977678 , 0.0977613 , 0.0985188 , 0.0988552 , 0.103929  , 0.096515  , 0.0969443 , 0.0959242 , 0.0960552 , 0.0947521 , 0.0885516 , 0.085634  , 0.0907114 , 0.0928643 , 0.0858903 , 0.0910437, 0.0773737 , 0.0685318 , 0.0719567  ,0.0837543  ,0.0995662 , 0.0993279 ,0.0955771 , 0.10246  , 0.102655 , 0.101682  ,0.104605  , 0.103271  , 0.0919026 ,0.0918631, 0.0702451 , 0.0719567 , 0.102055  , 0.105221 , 0.105359 },
	{ 0.104253  , 0.0992374 , 0.0961744 , 0.0963892 , 0.0978031 , 0.0977965 , 0.0985543 , 0.0988908 , 0.103966  , 0.0965497 , 0.0969792 , 0.0959587 , 0.0960898 , 0.0947862 , 0.0885835 , 0.0856648 , 0.0907441 , 0.0928978 , 0.0859212 , 0.0910765, 0.079074  , 0.0719567 , 0.0669203  ,0.0830542  ,0.0996021 , 0.0993636 ,0.0956116 , 0.102497 , 0.102692 , 0.101718  ,0.104642  , 0.103308  , 0.0919357 ,0.0918962, 0.0737557 , 0.0669203 , 0.102092  , 0.105259 , 0.105396 },
	{ 0.103391  , 0.0984164 , 0.0953788 , 0.0955918 , 0.0969939 , 0.0969875 , 0.0977389 , 0.0980727 , 0.103106  , 0.095751  , 0.0961769 , 0.0951648 , 0.0952948 , 0.0940021 , 0.0878506 , 0.0849561 , 0.0899933 , 0.0921292 , 0.0852104 , 0.090323 , 0.084515  , 0.0837543 , 0.0830542  ,0.0797057  ,0.0987781 , 0.0985416 ,0.0948206 , 0.101649 , 0.101842 , 0.100877  ,0.103777  , 0.102454  , 0.0911751 ,0.0911359, 0.0858481 , 0.0830542 , 0.101248  , 0.104388 , 0.104525 },
	{ 0.0975228 , 0.0890026 , 0.0942599 , 0.0983378 , 0.0996895 , 0.0997952 , 0.100119  , 0.100237  , 0.101829  , 0.0996407 , 0.0997179 , 0.0990308 , 0.0995321 , 0.0991311 , 0.0988764 , 0.098514  ,  0.0967695, 0.0958968 , 0.0988089 , 0.104737 , 0.0992055 , 0.0995662 , 0.0996021  ,0.0987781  ,0.0804175 , 0.0925853 ,0.0947237 , 0.0955044, 0.0956862, 0.0912276 ,0.106781  , 0.106616  , 0.105725  ,0.10568  , 0.102055  , 0.0996021 , 0.0824279 , 0.0980784, 0.100907 },
	{ 0.104414  , 0.097028  , 0.0982276 , 0.10148   , 0.103007  , 0.103086  , 0.103601  , 0.103813  , 0.106949  , 0.102549  , 0.102751  , 0.101922  , 0.102316  , 0.101588  , 0.0994568 , 0.0982782 ,  0.0957665, 0.0967909 , 0.0985723 , 0.104487 , 0.098968  , 0.0993279 , 0.0993636  ,0.0985416  ,0.0925853 , 0.0814551 ,0.0882397 , 0.0840233, 0.0841833, 0.0994537 ,0.110302  , 0.109728  , 0.105472  ,0.105427 , 0.101811  , 0.0993636 , 0.0948999 , 0.0862878, 0.106988 },
	{ 0.103719  , 0.0971197 , 0.09643   , 0.0991882 , 0.100738  , 0.100803  , 0.101386  , 0.101633  , 0.105356  , 0.100112  , 0.100363  , 0.099499  , 0.0998295 , 0.0989799 , 0.0960736 , 0.0945671 ,  0.0917987, 0.0936482 , 0.0948501 , 0.100541 , 0.0952309 , 0.0955771 , 0.0956116  ,0.0948206  ,0.0947237 , 0.0882397 ,0.0820552 , 0.0910219, 0.0911952, 0.0995477 ,0.107859  , 0.10712   , 0.10149   ,0.101446 , 0.0979666 , 0.0956116 , 0.0970918 , 0.093475 , 0.10583 },
	{ 0.107706  , 0.100087  , 0.101325  , 0.10468   , 0.106254  , 0.106336  , 0.106868  , 0.107087  , 0.110321  , 0.105783  , 0.105991  , 0.105135  , 0.105542  , 0.104791  , 0.102593  , 0.101377  ,  0.098786 , 0.0998427 , 0.10168   , 0.107781 , 0.102088  , 0.10246   , 0.102497   ,0.101649   ,0.0955044 , 0.0840233 ,0.0910219 , 0.0561588, 0.0620686, 0.102589  ,0.11378   , 0.113188  , 0.108798  ,0.108751 , 0.105021  , 0.102497  , 0.0978921 , 0.0636203, 0.110361 },
	{ 0.107911  , 0.100278  , 0.101518  , 0.104879  , 0.106457  , 0.106539  , 0.107071  , 0.107291  , 0.110531  , 0.105984  , 0.106192  , 0.105335  , 0.105742  , 0.10499   , 0.102788  , 0.10157   ,  0.0989741, 0.100033  , 0.101874  , 0.107986 , 0.102283  , 0.102655  , 0.102692   ,0.101842   ,0.0956862 , 0.0841833 ,0.0911952 , 0.0620686, 0.0545346, 0.102785  ,0.113997  , 0.113403  , 0.109005  ,0.108958 , 0.105221  , 0.102692  , 0.0980784 , 0.0558979, 0.110571 },
	{ 0.0963936 , 0.087192  , 0.0943785 , 0.0989094 , 0.10021   , 0.100329  , 0.100574  , 0.100651  , 0.101582  , 0.100344  , 0.100366  , 0.0997294 , 0.100289  , 0.100027  , 0.10061   , 0.100607  ,  0.0991721, 0.0974294 , 0.100908  , 0.106963 , 0.101313  , 0.101682  , 0.101718   ,0.100877   ,0.0912276 , 0.0994537 ,0.0995477 , 0.102589 , 0.102785 , 0.0712718 ,0.107353  , 0.107368  , 0.107972  ,0.107925 , 0.104224  , 0.101718  , 0.0935083 , 0.105354 , 0.100211 },
	{ 0.104732  , 0.104734  , 0.10168   , 0.0937359 , 0.0880383 , 0.0865793 , 0.0883277 , 0.0891657 , 0.0984206 , 0.090328  , 0.0891407 , 0.0897751 , 0.0914868 , 0.0943665 , 0.100914  , 0.103499  ,  0.104467 , 0.103495  , 0.103809  , 0.110037 , 0.104226  , 0.104605  , 0.104642   ,0.103777   ,0.106781  , 0.110302  ,0.107859  , 0.11378  , 0.113997 , 0.107353  ,0.0676398 , 0.096651  , 0.111076  ,0.111028 , 0.10722   , 0.104642  , 0.10945   , 0.116846 , 0.102832 },
	{ 0.10589   , 0.104749  , 0.101466  , 0.0939099 , 0.0912076 , 0.090328  , 0.0917741 , 0.0924589 , 0.100874  , 0.0839061 , 0.0861474 , 0.085699  , 0.086279  , 0.0917564 , 0.0992004 , 0.10218   ,  0.103538 , 0.102838  , 0.102485  , 0.108635 , 0.102897  , 0.103271  , 0.103308   ,0.102454   ,0.106616  , 0.109728  ,0.10712   , 0.113188 , 0.113403 , 0.107368  ,0.096651  , 0.0697795 , 0.109659  ,0.109612 , 0.105853  , 0.103308  , 0.109281  , 0.116238 , 0.10466 },
	{ 0.110663  , 0.105338  , 0.102087  , 0.102315  , 0.103816  , 0.103809  , 0.104613  , 0.10497   , 0.110358  , 0.102485  , 0.102941  , 0.101858  , 0.101997  , 0.100614  , 0.0940295 , 0.0909314 ,  0.0963229, 0.098609  , 0.0701352 , 0.0743433, 0.0915697 , 0.0919026 , 0.0919357  ,0.0911751  ,0.105725  , 0.105472  ,0.10149   , 0.108798 , 0.109005 , 0.107972  ,0.111076  , 0.109659  , 0.0608102 ,0.0750124, 0.0942002 , 0.0919357 , 0.108369  , 0.11173  , 0.111876 },
	{ 0.110615  , 0.105293  , 0.102043  , 0.102271  , 0.103771  ,  0.103764 , 0.104568  , 0.104925  , 0.110311  , 0.102441  , 0.102897  , 0.101814  , 0.101953  , 0.10057   , 0.0939891 , 0.0908923 ,  0.0962815, 0.0985666 , 0.0701051 , 0.0603513, 0.0915303 , 0.0918631 , 0.0918962  ,0.0911359  ,0.10568   , 0.105427  ,0.101446  , 0.108751 , 0.108958 , 0.107925  ,0.111028  , 0.109612  , 0.0750124 ,0.0428495, 0.0941597 , 0.0918962 , 0.108322  , 0.111682 , 0.111828 },
	{ 0.106821  , 0.101682  , 0.0985433 , 0.0987633 , 0.100212  ,  0.100205 , 0.100982  , 0.101327  , 0.106527  , 0.0989278 , 0.0993679 , 0.0983223 , 0.0984565 , 0.0971209 , 0.0907654 , 0.0877749 ,  0.0929792, 0.0951859 , 0.0880376 , 0.0933198, 0.0793081 , 0.0702451 , 0.0737557  ,0.0858481  ,0.102055  , 0.101811  ,0.0979666 , 0.105021 , 0.105221 , 0.104224  ,0.10722   , 0.105853  , 0.0942002 ,0.0941597, 0.0577012 , 0.0737557 , 0.104607  , 0.107852 , 0.107992 },
	{ 0.104253  , 0.0992374 , 0.0961744 , 0.0963892 , 0.0978031 ,  0.0977965, 0.0985543 , 0.0988908 , 0.103966  , 0.0965497 , 0.0969792 , 0.0959587 , 0.0960898 , 0.0947862 , 0.0885835 , 0.0856648 ,  0.0907441, 0.0928978 , 0.0859212 , 0.0910765, 0.079074  , 0.0719567 , 0.0669203  ,0.0830542  ,0.0996021 , 0.0993636 ,0.0956116 , 0.102497 , 0.102692 , 0.101718  ,0.104642  , 0.103308  , 0.0919357 ,0.0918962, 0.0737557 , 0.0397111 , 0.102092  , 0.105259 , 0.105396 },
	{ 0.0999608 , 0.0912276 , 0.0966164 , 0.100796  , 0.102182  ,  0.10229  , 0.102622  , 0.102743  , 0.104374  , 0.102132  , 0.102211  , 0.101507  , 0.10202   , 0.101609  , 0.101348  , 0.100977  ,  0.0991887, 0.0982942 , 0.101279  , 0.107356 , 0.101686  , 0.102055  , 0.102092   ,0.101248   ,0.0824279 , 0.0948999 ,0.0970918 , 0.0978921, 0.0980784, 0.0935083 ,0.10945   , 0.109281  , 0.108369  ,0.108322 , 0.104607  , 0.102092  , 0.0612731 , 0.10053  , 0.10343  },
	{ 0.110609  , 0.102785  , 0.104056  , 0.107501  , 0.109118  , 0.109202  , 0.109748  , 0.109973  , 0.113295  , 0.108634  , 0.108847  , 0.107969  , 0.108386  , 0.107615  , 0.105358  , 0.104109  , 0.101448  , 0.102534  , 0.104421  , 0.110686 , 0.10484   , 0.105221  , 0.105259   ,0.104388   ,0.0980784 , 0.0862878 , 0.093475 , 0.0636203, 0.0558979, 0.105354  , 0.116846 , 0.116238  , 0.11173   ,0.111682 , 0.107852  , 0.105259  , 0.10053   , 0.0416544, 0.113335 },
	{ 0.0803107 , 0.0977668 , 0.10002   , 0.0984174 , 0.0961025 , 0.0961045 , 0.0946577 , 0.09389   , 0.0796531 , 0.0978127 , 0.0972871 , 0.0972139 , 0.0983073 , 0.0994647 , 0.102981  , 0.104245  , 0.103955  , 0.102544  , 0.104557  , 0.110831 , 0.104977  , 0.105359  , 0.105396   ,0.104525   ,0.100907  , 0.106988  , 0.10583  , 0.110361 , 0.110571 , 0.100211  , 0.102832 , 0.10466   , 0.111876  ,0.111828 , 0.107992  , 0.105396  , 0.10343   , 0.113335 , 0.0682956 }
};
/////////////////////////////////////////////////
/*用于计算dVg的灵敏度矩阵*/
////////////////////////////////////////////////
double C2[39]=
{
	0,  0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0.0712718 , 0.0676398 , 0.0697795 , 0.0608102 , 0.0428495 , 0.0577012 , 0.0397111,  0.0612731,  0.0416544 , 0.0682956
};
/////////////////////////////////////////////
/*发电机母线与中枢母线的关联矩阵           */
/*如果发电机在中枢母线所在区域，则zoneij=1*/
/*i表示发电机母线编号，j表示中枢母线编号 */
/*矩阵中其余项为0                       */
///////////////////////////////////////////
int Zone[39][39]=
{
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 },
	{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0 },
	{ 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 }
};
///////////////////////////////////////////////////////////////
/*节点导纳矩阵的实部G                                       */
/////////////////////////////////////////////////////////////
double G[39][39]=
{
	{ 3.6545   ,  -2.05706  ,   0        , 0        , 0         ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , -1.59744 },
	{ -2.05706 ,  64.6457   ,   -5.65956 , 0        , 0         ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , -56.9291 ,0       ,  0         ,0       ,  0       ,  -0 , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,  -5.65956  ,   14.6906  , -2.85476 , 0         ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , -6.17631 , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   -2.85476 , 12.5076  , -4.86381  ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , -4.78899 , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , -4.86381 , 40.6208   ,-29.4118 ,  0        , -6.34518 , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        , -29.4118  ,46.8057  ,  -7.05882 , 0        , 0       , 0       ,  -10.3352  ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , -0,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,-7.05882 ,  25.8205  , -18.7617 , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  -6.34518 ,0        ,  -18.7617 , 26.8454  , -1.7385 , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , -1.7385  , 3.33594 , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , -1.59744 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 42.8954 ,  -21.4477  ,0         , -21.4477 , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  -0,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,-10.3352 ,  0        , 0        , 0       , -21.4477,  32.6273   ,-0.849478 , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  -0.849478 ,1.70915   , -0.849478, 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , -21.4477,  0         ,-0.849478 , 31.0453  , -8.75316 , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , -4.78899 ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , -8.75316 , 17.3386  , -3.79643 , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , -3.79643 , 13.8895  , -10.0931 , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , -10.0931 , 36.0258  , -8.78294 , 0        , -4.17962 , 0        , -4.37421,  0        , 0        , -8.59599 , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , -8.78294 , 23.4373  , -10.3352 , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  -4.31922  ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   -6.17631 , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , -10.3352 , 16.5115  , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , -4.17962 , 0        , 0        , 12.264   , -3.88624 , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  -3.70554 , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , -3.88624 , 6.48722  , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , -2.79579 , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , -4.37421 , 0        , 0        , 0        , 0        , 8.44256,   - 4.06835, 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , -4.06835 , 10.5534  , -6.48508 , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , -0 , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0,         - 6.48508, 8.94953  , -1.78885 , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , -0.675594,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , -8.59599 , 0        , 0        , 0        , 0        , 0       ,  0        , -1.78885 , 10.3848  , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   -56.9291 ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0      ,   0        , 0        , 0        , 61.1369  ,-3.03741,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  -1.14185,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , -3.03741 ,12.8034 ,  -6.42055  ,-1.89825,  -1.44716,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , -4.31922 , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,-6.42055,  10.7398   ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,-1.89825,  0         ,7.986   ,  -6.08775,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,-1.44716,  0         ,-6.08775,  10.9796 ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  -3.36066 , 0 },
	{ 0        ,   -0       ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,-0       ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , -0      ,   0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , -3.70554 , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  3.46312  , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , -2.79579 , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 2.77085  , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0 ,        - 0      , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , -0.675594, 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0.675594 ,  0       ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , -1.14185 ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  1.114   ,  0        , 0 },
	{ 0        ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , 0       , 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  -3.36066,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  3.27869  , 0 },
	{ -1.59744 ,   0        ,   0        , 0        ,  0        ,0        ,  0        , 0        , -1.59744, 0       ,  0         ,0         , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0        , 0       ,  0        , 0        , 0        , 0        ,0       ,  0         ,0       ,  0       ,  0  , 0 ,  0 ,  0        , 0        , 0  , 0        ,  0       ,  0        , 3.19489 }
};
///////////////////////////////////////////////////////////////
/*节点导纳矩阵的虚部B                                       */
/////////////////////////////////////////////////////////////
double B[39][39]=
{
	{ -63.3675,  24.1557 , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 39.9361 },
	{ 24.1557 ,  -217.33 , 65.7379 , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 69.9414  ,0       , 0       , 0        ,0       ,56.6298 , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  65.7379 , -186.843, 46.7741  ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 74.6771 , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 46.7741 , -201.571 ,77.821   , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 77.2224  ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 77.821   ,-548.844 , 382.353 , 0       , 88.8325 , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,382.353  , -657.306, 108.235 , 0       , 0      , 0        , 121.069 , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 42.8 , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 108.235 , -323.9  , 215.76  , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,88.8325  , 0       , 215.76  , -331.727, 27.4381, 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 27.4381 , -66.584, 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 39.9361 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , -518.298 , 230.563 , 0       , 230.563 , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 53.5  ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 121.069 , 0       , 0       , 0      , 230.563  , -374.483, 23.0952 , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 23.0952 , -46.4675, 23.0952 , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 230.563  , 0       , 23.0952 , -351.628, 98.2299  ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 77.2224  ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 98.2299 , -220.882 ,45.768   , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 45.768   ,-150.916 , 105.417 , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,105.417  , -510.428, 111.669 , 0       , 50.9391 , 0       , 73.8149 , 0        ,0       , 169.054 , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 111.669 , -289.923, 121.069 , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 57.4789 , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 74.6771 , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 121.069 , -195.573, 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 50.9391 , 0       , 0       , -212.43 , 76.6145 , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,75.1694 , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 76.6145 , -128.697, 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 55.9158 , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 73.8149 , 0       , 0       , 0       , 0       , -144.755, 71.1961  ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 71.1961 , -248.207 ,103.761 , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 71.6783 , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 103.761  ,-168.7  , 28.459  , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 36.7523 , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 169.054 , 0       , 0       , 0       , 0       , 0       , 0        ,28.459  , -197.299, 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  69.9414 , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , -145.526 ,30.6588 , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 44.1515 , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 30.6588  ,-133.587, 67.4157 , 20.9248  ,15.868  ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 57.4789 , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,67.4157 , -124.614, 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,20.9248 , 0       , -86.071  ,65.6607 ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,15.868  , 0       , 65.6607  ,-148.061,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 65.5328 , 0 },
	{ 0       ,  56.6298 , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,-55.2486, 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 42.8    , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , - 40 , 0     ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 53.5     , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , -50   ,0       , 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 75.1694 , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,-70.2518, 0       , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 55.9158 , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , -55.417 , 0       , 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 71.6783  ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , -69.9301, 0       , 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,36.7523 , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , -36.7523, 0       , 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 44.1515  ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , -43.0746, 0       , 0 },
	{ 0       ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 0      , 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,65.5328 ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , -63.9344, 0 },
	{ 39.9361 ,  0       , 0       , 0        ,0        , 0       , 0       , 0       , 39.9361, 0        , 0       , 0       , 0       , 0        ,0        , 0       , 0       , 0       , 0       , 0       , 0       , 0        ,0       , 0       , 0        ,0       , 0       , 0        ,0       ,0       , 0    , 0     ,0       , 0       , 0       , 0       , 0       , 0       , -78.8972 }
};

/////////////////////////////////////////
/*以下为程序用到的结构体*/
////////////////////////////////////////
/* 母线信息结构体 */
struct BusInfor
{
	int busno;
	double Volt;
	double V_ang;
};

struct BusInfor_T
{
	BusInfor Businfor;
	int BusType;
	double P;
	double Q;
};

BusInfor businfor_M[NUM_M];
BusInfor businfor_PBus[NUM_PBUS];
BusInfor businfor_Normal[NUM_NORMAL];

BusInfor businfor_PBus_Ref[NUM_PBUS];
BusInfor_T businfor_t[39];



/////////////////////////////////////////////////
/*以下为计算用功能函数                     */
////////////////////////////////////////////////
int GetPQ(BusInfor_T * businfo_ptr, int Bus_Num)
{
	double temp_res = 0;
	double temp_ang = 0;
	int i, j;
	ofstream P_file;
	ofstream Q_file;
	ofstream ang_file;

	for (i = 0; i<Bus_Num; i++)
	{
		//P
		temp_res = 0;
		for (j = 0; j<Bus_Num; j++)
		{
			temp_ang = businfo_ptr[i].Businfor.V_ang - businfo_ptr[j].Businfor.V_ang;
			temp_res += businfo_ptr[j].Businfor.Volt*(G[i][j] * cos(temp_ang*PI / 180) + B[i][j] * sin(temp_ang*PI / 180));
		}
		businfo_ptr[i].P = businfo_ptr[i].Businfor.Volt*temp_res;

		//Q
		temp_res = 0;
		for (j = 0; j<Bus_Num; j++)
		{
			temp_ang = businfo_ptr[i].Businfor.V_ang - businfo_ptr[j].Businfor.V_ang;
			temp_res += businfo_ptr[j].Businfor.Volt*(G[i][j] * sin(temp_ang*PI / 180) + B[i][j] * cos(temp_ang*PI / 180));
		}
		businfo_ptr[i].Q = businfo_ptr[i].Businfor.Volt*temp_res;
	}

	P_file.open("P.txt");
	Q_file.open("Q.txt");
	ang_file.open("Ang.txt");

	P_file << "P=" << endl;
	Q_file << "Q=" << endl;
	ang_file << "Ang=" << endl;
	for (i = 0; i<Bus_Num; i++)
	{
		P_file << "Bus " << i << "  " << businfo_ptr[i].P << endl;
		Q_file << "Bus " << i << "  " << businfo_ptr[i].Q << endl;
		ang_file << "Bus " << i << "  " << businfo_ptr[i].Businfor.V_ang << endl;
	}

	P_file.close();
	Q_file.close();
	ang_file.close();

	return 1;
}

int GetdQg(double *dQg_ptr, double *Cg_ptr, int *Zone_ptr, BusInfor *businfor_PBus_Ref_ptr, BusInfor *businfor_PBus_ptr, int Num_Bus, int Num_PBus)
{
	int i_M = 0;
	int i_PBus = 0;
	int i_PBus_ref = 0;
	int temp_no_M = 0;
	int temp_no_PBus = 0;
	int temp_no_PBus_ref = 0;

	//double *temp_V=new double[Num_Bus];
	double temp_V[39];

	memset(&temp_V[0], 0, Num_Bus);
	for (i_PBus_ref = 0; i_PBus_ref<Num_PBus; i_PBus_ref++)
	{
		temp_no_PBus_ref = businfor_PBus_Ref_ptr[i_PBus_ref].busno - 1;
		for (i_PBus = 0; i_PBus<Num_PBus; i_PBus++)
		{
			temp_no_PBus = businfor_PBus_ptr[i_PBus].busno - 1;

			if (temp_no_PBus_ref == temp_no_PBus)
			{
				temp_V[temp_no_PBus] = businfor_PBus_Ref_ptr[i_PBus_ref].Volt - businfor_PBus_ptr[i_PBus].Volt;
				//cout<<"temp_V[temp_no_PBus]:"<<temp_V[temp_no_PBus]<<endl;
				break;
			}
		}
	}

	/*matrixTrans(temp_CgT,Cg_ptr,Num_Bus,Num_Bus);
	Matrix_Mul(Cg_ptr,Num_Bus,temp_CgT,Num_Bus,Num_Bus,temp_CInv);
	matrixInversion(temp_CInv,Num_Bus);
	Matrix_Mul(temp_CgT,Num_Bus,temp_CInv,Num_Bus,Num_Bus,temp_dQg);
	Matrix_Mul(temp_dQg,Num_Bus,temp_V,1,Num_Bus,dQg_ptr);*/
	for (int i = 0; i<Num_Bus; i++)
	{
		for (int j = 0; j<Num_Bus; j++)
		{
			if (Zone_ptr[j*Num_Bus + i] == 1)
			{
				if (temp_V[i] >= 1e-5)
				{
					dQg_ptr[j] = temp_V[i] / Cg_ptr[j*Num_Bus + i];
				}
				else
				{
					dQg_ptr[j] = 0;
				}
			}
		}
	}

	Write_Matrix("dQg.txt", "dQg", dQg_ptr, 1, Num_Bus);

	return 1;
}

int GetdQgg(double *dQg_ptr, double *Cg_ptr, int *Zone_ptr, BusInfor *businfor_PBus_Ref_ptr, BusInfor *businfor_PBus_ptr, int Num_Bus, int Num_PBus)
{
	int i_M = 0;
	int i_PBus = 0;
	int i_PBus_ref = 0;
	int temp_no_M = 0;
	int temp_no_PBus = 0;
	int temp_no_PBus_ref = 0;
	for (int i = 0; i < 39; i++)
	{
		dQg_ptr[i] = 0;
	}
	//double *temp_V=new double[Num_Bus];
	double temp_V[39];
    memset(temp_V, 0, sizeof(double) * Num_Bus);

	for (i_PBus_ref = 0; i_PBus_ref < Num_PBus; i_PBus_ref++)
    {
		temp_no_PBus_ref = businfor_PBus_Ref_ptr[i_PBus_ref].busno - 1;
		for (i_PBus = 0; i_PBus < Num_PBus; i_PBus++)
		{
			temp_no_PBus = businfor_PBus_ptr[i_PBus].busno - 1;

			if (temp_no_PBus_ref == temp_no_PBus)
			{
				temp_V[temp_no_PBus] = businfor_PBus_Ref_ptr[i_PBus_ref].Volt - businfor_PBus_ptr[i_PBus].Volt;
				//cout<<"temp_V[temp_no_PBus]:"<<temp_V[temp_no_PBus]<<endl;
				break;
			}
		}
	}

	double Cg1 = Cg[38][0];
	double dQg39 = temp_V[0] / Cg1;
	double Cg28 = Cg[37][27];
	double dQg38 = temp_V[27] / Cg28;
	double Cg6[1][2] = { {Cg[30][5],Cg[31][5] } };
	double dQg31 = Cg6[0][0] * temp_V[5] / (pow(Cg6[0][0], 2) + pow(Cg6[0][1], 2));
	double dQg32 = Cg6[0][1] * temp_V[5] / (pow(Cg6[0][0], 2) + pow(Cg6[0][1], 2));

	double Cg3[1][2] = { { Cg[29][2],Cg[36][2] } };
	double dQg30 = Cg3[0][0] * temp_V[2] / (pow(Cg3[0][0], 2) + pow(Cg3[0][1], 2));
	double dQg37 = Cg3[0][1] * temp_V[2] / (pow(Cg3[0][0], 2) + pow(Cg3[0][1], 2));

	double Cg19[1][2] = { { Cg[32][18],Cg[33][18] } };
	double dQg33 = Cg19[0][0] * temp_V[18] / (pow(Cg19[0][0], 2) + pow(Cg19[0][1], 2));
	double dQg34 = Cg19[0][1] * temp_V[18] / (pow(Cg19[0][0], 2) + pow(Cg19[0][1], 2));

	double Cg23[1][2] = { { Cg[34][22],Cg[35][22] } };
	double dQg35 = Cg23[0][0] * temp_V[22] / (pow(Cg23[0][0], 2) + pow(Cg23[0][1], 2));
	double dQg36 = Cg23[0][1] * temp_V[22] / (pow(Cg23[0][0], 2) + pow(Cg23[0][1], 2));

	if (temp_V[0] > 1e-5)
	{
		dQg_ptr[38] = dQg39;
	}
	if (temp_V[27] > 1e-5)
	{
		dQg_ptr[37] = dQg38;
	}
	if (temp_V[5] > 1e-5)
	{
		dQg_ptr[30] = dQg31;
		dQg_ptr[31] = dQg32;
	}
	if (temp_V[2] > 1e-5)
	{
		dQg_ptr[29] = dQg30;
		dQg_ptr[36] = dQg37;
	}
	if (temp_V[18] > 1e-5)
	{
		dQg_ptr[32] = dQg33;
		dQg_ptr[33] = dQg34;
	}
	if (temp_V[22] > 1e-5)
	{
		dQg_ptr[34] = dQg35;
	    dQg_ptr[35] = dQg36;
    }

	Write_Matrix("dQg.txt", "dQg", dQg_ptr, 1, Num_Bus);
	//delete[] temp_V;

	return 1;
}


int GetdVg(double *dVg_ptr, double *dQg_ptr, double *C2_ptr, int Num_Bus)
{
	for (int i = 0; i<Num_Bus; i++)
	{
		dVg_ptr[i] = C2_ptr[i] * dQg_ptr[i];
	}

	Write_Matrix("dVg.txt", "dVg", dVg_ptr, 1, Num_Bus);
	return 1;
}

int CalculateDVG(BusInfor *businfo_ptr, int Bus_Num, double* dvg_ret)
{
	businfor_PBus_Ref[0].busno = PilotBusNo[0];
	businfor_PBus_Ref[0].Volt = 1.047356;
	businfor_PBus_Ref[1].busno = PilotBusNo[1];
	businfor_PBus_Ref[1].Volt = 1.050122;
	businfor_PBus_Ref[2].busno = PilotBusNo[2];
	businfor_PBus_Ref[2].Volt = 1.007672;
	businfor_PBus_Ref[3].busno = PilotBusNo[3];
	businfor_PBus_Ref[3].Volt = 1.030173;
	businfor_PBus_Ref[4].busno = PilotBusNo[4];
	businfor_PBus_Ref[4].Volt = 1.049861;
	businfor_PBus_Ref[5].busno = PilotBusNo[5];
	businfor_PBus_Ref[5].Volt = 1.044789;

    int i=0;
    for (i=0;i<Bus_Num;i++)
	{
		memcpy((char*)&(businfor_t[i].Businfor), (char *)&(businfo_ptr[i]), sizeof(BusInfor));
	}

	int cnt_M = 0;
	int cnt_PBus = 0;
	int cnt_Normal = 0;
    for (i = 0; i<Bus_Num; i++)
    {
		for (int k = 0; k<NUM_M; k++)
		{
			if (businfor_t[i].Businfor.busno == MachineNo[k])
			{
				businfor_t[i].BusType = BUS_TYPE_M;
				memcpy(&businfor_M[cnt_M], &(businfor_t[i].Businfor), sizeof(BusInfor));
				cnt_M++;
				break;
			}
		}

		for (int k = 0; k<NUM_PBUS; k++)
		{
			if (businfor_t[i].Businfor.busno == PilotBusNo[k])
			{
				businfor_t[i].BusType = BUS_TYPE_PBUS;
				memcpy(&businfor_PBus[cnt_PBus], &(businfor_t[i].Businfor), sizeof(BusInfor));
				//cout<<"///BusNo:"<<businfor_t[i].Businfor.busno<<"///volt:"<<businfor_t[i].Businfor.Volt<<"///V_ang:"<<businfor_t[i].Businfor.V_ang<<"///Type:"<<businfor_t[i].BusType<<std::endl;
				cnt_PBus++;
				break;
			}
		}

        if (businfor_t[i].BusType == BUS_TYPE_NORMAL)
		{
			memcpy(&businfor_Normal[cnt_Normal], &(businfor_t[i].Businfor), sizeof(BusInfor));
			cnt_Normal++;
        }
	}

	double dQg[39] = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };
	double dVg[39]{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };

    //P Q
	GetPQ(businfor_t, 39);

    //delta Qg
	GetdQgg(dQg, &Cg[0][0], &Zone[0][0], businfor_PBus_Ref, businfor_PBus, 39, NUM_PBUS);

    //delta Vg
	GetdVg(dVg, dQg, C2, 39);

    memcpy(dvg_ret, dVg, 39 * sizeof(double));

	return 1;
}
